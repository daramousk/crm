<openerp>
    <data>
        <record
            id="res_partner_publication_form"
            model="ir.ui.view">
            <field name="name">res.partner.publication.form</field>
            <field name="model">res.partner</field>
            <field name="type">form</field>
            <field
                name="inherit_id"
                ref="base.view_partner_form"
            />
            <field
                name="arch"
                type="xml">
                <xpath
                    expr="//page[contains(@string,'Purchases')]"
                    position="after"
                >
                    <page
                        string="Subscriptions"
                    >
                        <separator string="Subscriptions" />
                        <label for="distribution_preference" />
                        <field name="distribution_preference" />
                        <field name="subscription_ids">
                            <tree>
                                <field name="publication_id" />
                                <field name="date_start" />
                                <field name="date_end" />
                                <field name="email_distribution" />
                                <field name="print_distribution" />
                                <field name="product_id" />
                            </tree>
                            <form>
                                <field
                                    name="publication_id"
                                    domain="[('active','=',True),]"
                                    options="{'create': false, 'create_edit': false}"
                                    on_change="on_change_publication_id(publication_id, parent.distribution_preference)"
                                />
                                <group 
                                    colspan="4" col="2"
                                    attrs="{'invisible': [('publication_id','=',False),]}"
                                >
                                    <field name="date_start" />
                                    <field name="date_end" />
                                    <field name="email_distribution" />
                                    <field name="print_distribution" />
                                    <field
                                        name="copies"
                                        attrs="{
                                            'invisible': [('print_distribution','=',False)]
                                        }"
                                    />
                                    <field
                                        name="product_id"
                                        domain="[
                                            ('publication_id','=',publication_id),
                                            ('email_distribution','=',email_distribution),
                                            ('print_distribution','=',print_distribution),
                                        ]"
                                        options="{'create': false, 'create_edit': false}"
                                    />
                                </group>
                            </form>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>

    </data>
</openerp>
